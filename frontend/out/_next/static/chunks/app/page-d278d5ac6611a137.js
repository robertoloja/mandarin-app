(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{9693:(e,n,t)=>{Promise.resolve().then(t.bind(t,1431))},1431:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>N});var r=t(5155),i=t(2115),o=t(9949),s=t(6500),a=t(9829),l=t(3885),d=t(1084),c=t(2651);let h="https://mandobot.pythonanywhere.com/api",x=c.A.create({baseURL:h}),m=e=>{var n;let t=null===(n=e.response)||void 0===n?void 0:n.status;return t&&401!==t&&console.error(e),Promise.reject(e)};x.interceptors.response.use(void 0,e=>m(e));let p={segment:async function(e){return(await x.post("/segment?data=".concat(e))).data},sse:function(e,n,t){let r=new EventSource("".concat(h,"/segment?taskId=").concat(e));return r.onmessage=e=>{try{let t=JSON.parse(e.data);n(t)}catch(e){console.error("Failed to parse SSE message",e)}},r.onerror=e=>{t?t(e):console.error("SSE Connection error:",e)},r}};var u=t(2533),g=t(3420),j=t(3083);let f=function(e){return(0,r.jsxs)(g.T,{border:"solid 1px #468DA4",padding:"0.5rem",paddingTop:"0",backgroundColor:"#85E2FF",children:[(0,r.jsx)(j.E,{fontSize:"3xl",fontWeight:"bold",children:e.hanzi}),e.pinyin?(0,r.jsx)(j.E,{fontSize:"l",children:e.pinyin.toLowerCase()}):null]})};var w=t(5442),b=t(674);let v=function(e){return(0,r.jsxs)(g.T,{children:[(0,r.jsx)(w.D,{children:e.word}),e.definitions.map((e,n)=>(0,r.jsx)(j.E,{textAlign:"center",children:e},n)),1!==e.word.split("").length?(0,r.jsx)(g.T,{align:"start",children:e.word.split("").map((n,t)=>(0,r.jsxs)(b.z,{children:[(0,r.jsx)(f,{hanzi:n,pinyin:e.character_definitions[n].pinyin}),(0,r.jsx)(j.E,{children:e.character_definitions[n].english})]},t))}):void 0]})};var y=t(3166),S=t(6987),E=t(6677),C=t(2311),k=t(5477),z=t(7504),_=t(3862),W=t(9399);let A=function(e){let n=e.word.word===e.pronunciation[0],{isOpen:t,onOpen:i,onClose:o}=(0,y.j)();return(0,r.jsx)("div",{children:n?(0,r.jsx)(u.s,{align:"center",justify:"center",h:"70%",m:2,children:(0,r.jsx)(j.E,{fontSize:"lg",children:e.word.word})}):(0,r.jsxs)(S.Z,{variant:"unstyled",backgroundColor:"#B8EEFF",margin:"0.1rem",marginBottom:"0.5rem",padding:"0.2rem",border:"1px solid #468DA4",borderRadius:"4",boxShadow:"1px 1px 1px rgba(0, 0, 0, 0.25)",onClick:i,children:[n?null:(0,r.jsxs)(E.aF,{isOpen:t,onClose:o,isCentered:!0,children:[(0,r.jsx)(C.m,{}),(0,r.jsx)(k.$,{maxWidth:"90vw",maxHeight:"90vh",width:"auto",height:"auto",onClick:o,children:(0,r.jsx)(z.c,{display:"flex",p:"3rem",overflow:"scroll",children:(0,r.jsx)(v,{word:e.word.word,definitions:e.definitions,character_definitions:e.dictionary})})})]}),(0,r.jsx)(_.b,{children:(0,r.jsx)(l.o,{children:(0,r.jsx)(b.z,{spacing:"0.1rem",children:e.word.word.split("").map((n,t)=>(0,r.jsx)(f,{hanzi:n,pinyin:e.pronunciation[t]},t))})})}),(0,r.jsx)(l.o,{children:(0,r.jsx)(W.w,{children:(0,r.jsx)(j.E,{noOfLines:2,maxWidth:"10rem",minWidth:"5rem",fontSize:"sm",height:"2.6rem",marginTop:"0.5rem",marginBottom:"0.5rem",textAlign:"center",children:e.definitions.join("; ")})})})]})})},F=function(e){return(0,r.jsx)(u.s,{align:"stretch",w:"100%",h:"100%",px:["0","5%"],flexWrap:"wrap",mb:["45vh","20vh"],overflowX:"hidden",children:e.sentence.map((e,n)=>(0,r.jsx)(A,{word:e,pronunciation:e.pinyin,definitions:e.definitions,dictionary:e.dictionary},n))})},T=function(e){let[n,t]=(0,i.useState)(!1);return(0,r.jsxs)(o.a,{className:"translation",p:4,borderWidth:1,borderBottomWidth:0,borderTopRadius:"lg",borderColor:"black",position:"fixed",bottom:0,left:["0%","10%"],right:["0%","10%"],width:["100%","80%"],height:n?"1vh":["45vh","20vh"],overflowY:n?"hidden":"scroll",shadow:"md",bg:"white",zIndex:1,children:[(0,r.jsx)(o.a,{onClick:()=>t(!n),width:"40%",minW:"10rem",height:"0.3rem",bg:"darkgrey",borderRadius:"md",cursor:"pointer",position:"fixed",left:"50%",transform:"translateX(-50%)"}),(0,r.jsx)(l.o,{children:(0,r.jsx)(j.E,{mt:3,textAlign:"justify",px:5,children:e.text})})]})};function N(){let[e,n]=(0,i.useState)(!1),[t,c]=(0,i.useState)(""),[h,x]=(0,i.useState)({translation:"",dictionary:{},sentence:[]}),m="",u=e=>{n(!1),x(n=>({translation:n.translation+" "+e.message.translation,dictionary:{},sentence:[...n.sentence,...e.message.sentence]}))},g=e=>{console.error(e)},j=async e=>{e.preventDefault(),n(!0);try{await p.segment(t).then(e=>{m=e}).finally(()=>{console.log("Attempting to connect to SSE...");let e=p.sse(m,u,g);console.log("SSE connection established."),e.addEventListener("close",()=>{console.log("Closing connection"),e.close()}),e.onerror=n=>{console.error(n),e.close()}})}catch(e){console.error(e)}};return(0,r.jsxs)(o.a,{h:"100%",children:[(0,r.jsxs)("form",{onSubmit:j,children:[(0,r.jsx)(s.p,{type:"text",placeholder:"Enter Mandarin text",value:t,onChange:e=>{c(e.target.value)},mt:10}),(0,r.jsx)(a.$,{type:"submit",colorScheme:"teal",m:2,children:"Submit"})]}),e?(0,r.jsx)(l.o,{children:(0,r.jsx)(d.P,{isIndeterminate:!0,color:"green.300"})}):(0,r.jsxs)(o.a,{h:"100%",children:[(0,r.jsx)(F,{sentence:h.sentence,translation:h.translation,dictionary:h.dictionary}),0!==h.sentence.length?(0,r.jsx)(T,{text:h.translation}):null]})]})}}},e=>{var n=n=>e(e.s=n);e.O(0,[993,320,441,517,358],()=>n(9693)),_N_E=e.O()}]);